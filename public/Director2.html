<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Checkpoint 2 | Redirecting...</title>
    <style>
        body {
            text-align: center;
            padding-top: 50px;
            font-family: sans-serif;
            background: #121212;
            color: #eee;
        }
    </style>
</head>
<body>
    <h1>Checkpoint 2 | You are being redirected to your key...</h1>
    <p>If not redirected automatically, <a id="redirectLink" href="https://corgiside.vercel.app/Key.html">click here</a>.</p>

    <script>
    async function processCheckpointsAndRedirect() {
        try {
            // Retrieve the freeKey stored in localStorage on checkpoint1 page
            const freeKey = localStorage.getItem("freeKey");

            if (freeKey) {
                // Call API to set checkpoint2 = 1
                const setCheckpointUrl = `https://noah.customcloudapp.net/api.php?f=setCheckpoint2&freeKey=${encodeURIComponent(freeKey)}&checkPointValue=1`;
                const updateRes = await fetch(setCheckpointUrl);
                const updateData = await updateRes.json();
                console.log("SetCheckpoint2 response:", updateData);
            } else {
                console.warn("No freeKey found in localStorage");
            }
        } catch (error) {
            console.error("Error updating checkpoint2:", error);
        } finally {
            // Redirect after 3 seconds, no matter what
            setTimeout(() => {
                window.location.href = document.getElementById("redirectLink").href;
            }, 3000);
        }
    }

    processCheckpointsAndRedirect();
</script>

</body>
</html>


